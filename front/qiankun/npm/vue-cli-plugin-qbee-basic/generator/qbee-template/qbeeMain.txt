import singleSpaVue from 'single-spa-vue';
import Vue from 'vue';
import App from './App.vue';
import i18n from './locales/index';
import router from './router';
import store from './store';
import { keepAliveUtil } from '@qbee/qbee-common-lib';

if (process.env.NODE_ENV !== 'production') {
  Vue.component('QbeeRouter', keepAliveUtil.QbeeRouterComponent);
}

const vueOptions = {
  router,
  store,
  i18n,
  render: (h: any) => h(App),
};

// singleSpaVue包装一个vue微前端服务对象
const vueLifecycles = singleSpaVue({
  Vue,
  appOptions: vueOptions,
});
// 导出生命周期
export const bootstrap = vueLifecycles.bootstrap; // 启动时
export const mount = vueLifecycles.mount; // 挂载时
export const unmount = vueLifecycles.unmount; // 卸载时
if (!(window as any).singleSpaNavigate) {
  // 如果不是single-spa模式
  new Vue(vueOptions).$mount("#app");
}
export default vueLifecycles;
