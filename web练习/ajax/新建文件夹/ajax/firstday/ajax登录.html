<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
</head>

<body>
	<div>
		<div id="showInfo"></div>
		<form action="">
			用户名：<input type="text" name="username" id="username"><br>
			密码：<input type="password" id="password">
			<input type="button" id="btn" value="登录">
		</form>
	</div>
	<script>
		window.onload = function(){
			var btn = document.getElementById('btn');
			btn.onclick = function(){
				var username = document.getElementById('username').value ;
				var password = document.getElementById('password').value;
				//创建对象
				//秘书出场
				//XMLHttpRequest 是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在 AJAX 中被大量使用。
			var xhr = null;
			if(window.XMLHttpRequest){
				xhr = new XMLHttpRequest();
			}else{
				xhr = new ActiveXObject("Microsoft.XMLHTTP");
			}
			
			//xhr去向服务器请求数据,服务器返回数据给xhr，之后通知浏览器数据回来了
			//准备好了
			var url = './check.php?username='+username+"&password="+password;
			xhr.open('post',url,false);//不推荐使用同步(false)
			
			//事情办完之后干什么
			//浏览器收到xhr返回的数据渲染页面
			//这段代码在xhr.send();执行完之后执行
			xhr.onreadystatechange = function(){
				if(xhr.readyState == 4){
					if(xhr.status == 200){
						alert(1);
						var data = xhr.responseText;
						if(data == 1){
							document.getElementById('showInfo').innerHTML = '用户名或者密码错误';
						}else if(data == 2){
							document.getElementById('showInfo').innerHTML = '登录成功';
						}
					}
				};
			}
		
			//浏览器接着干别的事情
			xhr.send(null);
				alert(2);
		}
			}
			
	</script>
</body>
</html>
